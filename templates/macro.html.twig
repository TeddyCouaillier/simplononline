{# Error message for a form #}
{% macro checkMessage(form, message = null) %}
    {% if not form.vars.valid %}
        <div>
            <div class="messages-warning flex just-around align-center bg-white shadow w-50 mx-auto py-3 px-4 mb-4">
                <div class="message-icon-warning">
                    <i class="fas fa-exclamation-circle icon-sm pr-4"></i>
                </div>
                <p class="w-100">
                    <span class="bold">
                        Erreur
                    </span><br>
                    <span class="text-grey">Il y a une ou plusieurs erreurs de saisie.</span><br>
                    {% if message != null %}
                    <span class="text-grey">{{ message }}</span>
                    {% endif %}
                </p>
                <button type="button" class="close close-message text-grey">
                    <span>&times;</span>
                </button>
            </div>
        </div>
    {% endif %}
{% endmacro %}

{# Button confirm #}
{% macro confirm() %}
    <div class="text-center">
        <button type="submit" class="bg-red text-white button-circle mt-3 mb-1">&#10004;</button>
    </div>
{% endmacro %}

{# Skill modal #}
{% macro skillModal(skillUser) %}
    {% set skill = skillUser.skill %}
    <div id="myModal" class="modal" data-modalid="{{ skill.id }}">
        <div class="modal-content">
            <div class="close-modal text-right">&times;</div>
            <div class="mb-4 w-75 mx-auto">
                <h2>{{ skill.label }}</h2>
                <hr>
                <div class="text-justify mb-4">
                    {{ skill.description }}
                </div>
            </div>
        </div>
    </div>
{% endmacro %}

{# Skill level + modal on click popover #}
{% macro level(skillUser) %}
    {% import _self as template %}
    {% set skill = skillUser.skill %}
    {{ template.skillModal(skillUser) }}
    <div
    data-modalid="{{ skill.id }}" class="flex align-center skill-user" tabindex="0" data-toggle="popover" data-trigger="focus" data-html="true" data-container="body" data-placement="top"
    data-content="{{ skill.label }}<hr><div class='modal-button skill-info'>Détails</div>">
        <div class="skill-label">{{ skill.label }}</div>
        <div class="level level-{{ skillUser.level }} ml-auto">{{ skillUser.level }}</div>
    </div>
{% endmacro %}

{# Task container #}
{% macro task(tasks, project, type) %}
    <div class="testt">
        <input type="hidden" id="task-counter" value="{{tasks|length}}">
        {% for task in tasks if task is not null %}
            {{ _self.deleteConfirm(task.id,path('project_delete_task',{'id_task':task.id,'slug':project.slug})) }}
            {{ _self.modal("modal-edit-"~task.id) }}
            <div class="mt-2">
                <div class="container-white flex align-center task-container">
                    <div id="task-title">
                        <span class="bold">{{ task.title }}</span><br>
                        <span class="text-grey">{{ task.interval }}</span>
                    </div>
                    <div class="text-right" id="task-users">
                        {% for user in task.users %}
                            <img src="/img/avatar/{{user.avatar}}" class="avatar-xs" data-toggle="tooltip" data-placement="top" title="{{user.fullname}}">
                        {% endfor %}
                    </div>
                    <div class="text-center text-grey" id="task-sub">
                        <i class="fal fa-tasks mr-2"></i>
                        <span class="text-small"> {{ task.subtasksdone }} / {{ task.subtasks|length}} </span>
                    </div>
                <div>
                    {% if project.completed == false %}
                    <div class="subnav">
                        <i class="fas fa-ellipsis-v"></i>
                        <div class="subnav-tooltip">
                            <a class="subnav-link edit-task" data-toggle="modal" data-target="#modal-edit-{{task.id}}" data-url="{{ path('project_edit_task',{'slug':project.slug,'id_task':task.id}) }}">Modifier</a><br>
                            <a class="subnav-link text-red"  data-toggle="modal" data-target="#modal-{{task.id}}">Supprimer</a>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% if tasks|length >= 5 %}
    <div class="text-center my-2">
        <button class="btn button-see-task py-1 px-3" data-url="{{path('project_seemore',{'slug':project.slug})}}" data-type="{{type}}" onclick="seeMore(this)">Voir plus</button>
    </div>
    {% endif %}
{% endmacro %}

{% macro deleteConfirm(id,route,text = '') %}
<div class="modal fade bd-example-modal-lg" id="modal-{{id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header" style="border-bottom: none!important;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body px-5 pt-3 pb-5">
                <h2>Confirmation de suppression</h2>
                <hr>
                <div class="text-center mb-4">
                    <p>{{ text }}</p>
                    <b>Êtes-vous sur de vouloir supprimer cet élément ? </b><br>
                    <a href="{{ route|raw }}">
                        <button type="submit" class="bg-red text-white button-circle mt-3">&#10004;</button>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endmacro %}

{% macro modal(id) %}
    <div class="modal fade bd-example-modal-lg" id="{{id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-body px-5 pt-3 pb-5">

                </div>
            </div>
        </div>
    </div>
{% endmacro %}

{% macro modalPromotion(id) %}
    <div class="modal fade" id="{{id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">

                </div>
            </div>
        </div>
    </div>
{% endmacro %}